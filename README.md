# Pentesting-Live-Targets

Three versions of the Globitek website are available to you. They are mostly
identical. However, each one has been given a different color menu bar—blue,
green, red—and each one has been given two different security vulnerabilities.

Given ip address: `https://35.184.134.15/`

Your challenge is to attempt to find and exploit the vulnerabilities. The goal
is to identify which two vulnerabilities blue has, which two vulnerabilities
green has, and which two vulnerabilities red has.

Challenge Goals:

The following goals must be completed:

- [x] **Username Enumeration** : A careless developer mistake has created a
  username enumeration vulnerability. Determine which color has the
  vulnerability. You can use the existing username "jmonroe99" as a test. Next,
  figure out what mistake the developer made.

> GREEN (The error displayed is not in bold when non-existant user tries to
  login.
  
  The developer uses different classes for when the error exists due to 
  non-existant username (class="failed"), which is not defined in the 
  /green/public/styles.css, but for other errors, the developer uses 
  class="failure" which is described in the given styles.css.

  Reading: [Username Enumeration](http://guides.codepath.com/websecurity/Username-Enumeration)


- [x] **Insecure Direct Object Reference** : One of the three sites is missing
  code which would prevent some sensitive information from being made public.
  Determine which color has the vulnerability. Then, figure out what the other
  two sites did correctly to prevent the information leak.
  
> RED
  
```
  id    name
  1     Daron Burke
  2     Sherry Trevino
  3     Irene Boling
  4     Robert Hamilton
  5     Ken Barker
  6     Elizabeth Olson
  7     Samuel Hunter
  8     Kim Stanley
  9     Barbara Hinckley
Legal till here, illegal beyond, only available in RED:
  10    Testy McTesterson
  11    Lazy Lazyman
```

  Reading: [Insecure Direct Object Reference](http://guides.codepath.com/websecurity/Insecure-Direct-Object-Reference)

- [x] **SQL Injection** : Most of the data input received by these websites is
  being sanitized properly. However, one of the three sites has one place where
  the input is not being sanitized before being used in an SQL query. Determine
  which color has the vulnerability.

> BLUE

  In the url for the specific salesperson
```
/blue/public/salesperson.php?id=%27%20OR%20SLEEP(5)=0--%27
```
    
Reading: [SQL injection](http://guides.codepath.com/websecurity/SQL-Injection)

- [x] **Cross-Site Scripting** : All three sites do a good job of protecting
  against a reflected XSS attack. However, one of the sites has a mistake which
  leaves the site vulnerable to a stored XSS attack. A reflected XSS attack
  would be easy to reveal, while a stored XSS does not provide instant
  feedback. You will need to log into the admin area and look through the CMS
  in order to "spring the trap" and find out if your attack succeeded.
  Determine which color has the vulnerability. Use your name in the XSS so that
  your results won't be confused with anyone else's (example:
  <script>alert('Mallory found the XSS!');</script>).

> GREEN

  Users can insert a blind xss through the feedback form, which gets activated
  when admins try to open the list of feedback from Staff Menu > Feedback


```
# signin using pperson StaR!49*whiz
<script>alert('samman found the blind xss');</script>
```

  Reading: [Cross Site
  Scripting](http://guides.codepath.com/websecurity/Cross-Site-Scripting)

- [ ] **Cross-Site Request Forgery** : One of the three sites does not have
  CSRF protections on the admin area. A clever attacker could design a form
  which would automatically submit form data to the staff area and take
  advantage of a logged in user's access permissions. Be the attacker and
  design a form which will make a change to the spelling of some database
  content. (For example, change the first user from "James" to "Jim", or change
  "Alabama" to "Alabamaaaa".) Then point the form action at each of the three
  sites to find out which color has the vulnerability. Do not neglect to be
  stealthy with your form—your unsuspecting, logged-in admin should neither see
  the form nor the results of the form submission.

- [ ] **Session Hijacking/Fixation** : Two of the three websites expire their
  active sessions and require users to re-login every 30 minutes. That is
  probably too aggressive for the real world, but it is better than the third
  site which allows sessions to be a year old, and never regenerates the
  session ID, even when the user agent string changes. This makes it vulnerable
  to both session hijacking and session fixation attacks.

There are many ways an attacker could get or set the session ID in the real
world (XSS, sniffing WiFi packets, etc.). For this exercise, a PHP script has
been provided to help you, "public/hacktools/change_session_id.php". You can
load this script to find out the current session ID or to set it to a new one.

Use two different web browsers (e.g., Firefox and Chrome). Let one browser be
the attacker and the other the target. Choose if you want to attempt a session
hijacking or session fixation. For hijacking, log the target in first, then
give the logged-in session ID to the attacker. For fixation, get a session ID
for the attacker, give it to the target, then the target will log in. In both
cases, the attacker should now have access to the staff area.

Determine which color has the vulnerability.

## The following advanced goals are optional:

* Bonus Objective 1: Build on Objective #3 (SQL Injection). Experiment to see
  what other kinds of information you can get the database to reveal.

* Bonus Objective 2: Build on Objective #4 (Cross-Site Scripting). Experiment
  to see if you can use XSS to: a) direct the user to a new URL, b) read cookie
  data, c) set cookie data.

Advanced Objective: Build on Objectives #4 and #6 (XSS, hijacking/fixation).
Are you able to execute a session hijacking or fixation attack using XSS
instead of using the provided PHP script?

## Concept Review
* Which attacks were easiest to execute? Which were the most difficult?
 
* What is a good rule of thumb which would prevent accidentally username
  enumeration vulnerabilities like the one created here?
 
* Since you should be somewhat familiar with the CMS and how it was coded, can
  you think of another resource which could be made vulnerable to an Insecure
  Direct Object Reference? What code could be removed which would expose it?
  (Hint: It was also the answer to the first bonus objective to the Weekly
  Assignment for week 3.)
 
* Many SQL Injections use OR as part of the injected code. (For example: ' OR
  1=1 --'.) Could AND work just as well in place of OR? (For example: ' AND 1=1
  --'.) Why or why not?
 
* A stored XSS attack requires patience because it could be stored for months
  before being triggered. Because of this, what important ingredient would an
  attacker most likely include in a stored XSS attack script?
 
* Imagine that one of your classmates is an authorized admin for the site's CMS
  and you are not. How would you get them to visit the self-submitting, hidden
  form page you created in Objective #5 (CSRF)?
 
* Compare session hijacking and session fixation. Which attack do you think is
  easier for an attacker to execute? Why? One of them is much easier to defend
  against than the other. Which one and why?
